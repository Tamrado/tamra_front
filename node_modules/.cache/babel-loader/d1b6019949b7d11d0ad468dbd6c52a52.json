{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _classCallCheck from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{AuthContent,InputWithLabel,AuthButton,AuthError,Label}from'../../components/Auth';import{bindActionCreators}from'redux';import{connect}from'react-redux';import*as userPageActions from'../../redux/modules/userPage';import*as userActions from'../../redux/modules/user';import*as authActions from'../../redux/modules/auth';import storage from'../..//lib/storage';import{setError,validate,checkEmailExists,checkPhoneExists,inputStyle,setAuthActions,setPassword}from'../Function/ValidateModule';var UserModify=/*#__PURE__*/function(_Component){_inherits(UserModify,_Component);function UserModify(){var _getPrototypeOf2;var _this;_classCallCheck(this,UserModify);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(UserModify)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.checkIfUserPassed=function(){var username=_this.props.username;if(!storage.get('passed'))window.location.href='/@'+username+\"/password\";else storage.remove('passed');};_this.initialModifyInfo=function _callee(){var _this$props,username,UserPageActions,user;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=_this.props,username=_this$props.username,UserPageActions=_this$props.UserPageActions;_context.prev=1;_context.next=4;return _regeneratorRuntime.awrap(UserPageActions.checkUserAndGetUser());case 4:user=_this.props.result.toJS();UserPageActions.setUserData(user);_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0);window.location.replace('/@'+username+\"/password\");case 12:case\"end\":return _context.stop();}}},null,null,[[1,8]]);};_this.checkedChange=function(e){var UserPageActions=_this.props.UserPageActions;var _e$target$checked=e.target.checked,name=_e$target$checked.name,value=_e$target$checked.value;UserPageActions.changeInput({name:name,value:value,form:'User'});};_this.defaultNullChange=function(e){var UserPageActions=_this.props.UserPageActions;var _e$target=e.target,name=_e$target.name,value=_e$target.value;UserPageActions.changeInput({name:name,value:value,form:'User'});};_this.handleChange=function(e){var UserPageActions=_this.props.UserPageActions;var _e$target2=e.target,name=_e$target2.name,value=_e$target2.value;UserPageActions.changeInput({name:name,value:value,form:'User'});setPassword(_this.props.password);var validation=validate[name](value);if(name.indexOf('password')>-1||!validation)return;if(name.indexOf('email')>-1)checkEmailExists(value);else if(name.indexOf('phone')>-1)checkPhoneExists(value);};_this.handleLocalRegister=function _callee2(){var _this$props2,form,UserPageActions,error,history,_form$toJS,email,id,password,passwordConfirm,phone,name,comment,address,gender,birthday;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$props2=_this.props,form=_this$props2.form,UserPageActions=_this$props2.UserPageActions,error=_this$props2.error,history=_this$props2.history;_form$toJS=form.toJS(),email=_form$toJS.email,id=_form$toJS.id,password=_form$toJS.password,passwordConfirm=_form$toJS.passwordConfirm,phone=_form$toJS.phone,name=_form$toJS.name,comment=_form$toJS.comment,address=_form$toJS.address,gender=_form$toJS.gender,birthday=_form$toJS.birthday;if(!error){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:if(!(!validate['email'](email)||!validate['password'](password)||!validate['passwordConfirm'](passwordConfirm)||!validate['name'](name)||!validate['comment'](comment)||!validate['phone'](phone)||!validate['gender'](gender))){_context2.next=6;break;}return _context2.abrupt(\"return\");case 6:_context2.prev=6;_context2.next=9;return _regeneratorRuntime.awrap(UserPageActions.modifyUserInfo({email:email,id:id,password:password,name:name,comment:comment,phone:phone,address:address,gender:gender,birthday:birthday}));case 9:window.location.href='/';storage.remove('passed');_context2.next=17;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](6);if(_context2.t0.response.status===411)setError('조건에 맞는 데이터를 입력해주세요.');if(_context2.t0.response.status===409)setError('다른 회원과 일치하는 데이터가 있습니다. 다시 입력해주세요.');case 17:case\"end\":return _context2.stop();}}},null,null,[[6,13]]);};return _this;}_createClass(UserModify,[{key:\"componentDidMount\",value:function componentDidMount(){this.checkIfUserPassed();this.initialModifyInfo();setAuthActions(this.props.AuthActions);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){var UserPageActions=this.props.UserPageActions;UserPageActions.initializeForm('User');}},{key:\"render\",value:function render(){var _this$props3=this.props,error=_this$props3.error,form=_this$props3.form,errorId=_this$props3.errorId;var _form$toJS2=form.toJS(),id=_form$toJS2.id,password=_form$toJS2.password,passwordConfirm=_form$toJS2.passwordConfirm,email=_form$toJS2.email,name=_form$toJS2.name,phone=_form$toJS2.phone,birthday=_form$toJS2.birthday,comment=_form$toJS2.comment,address=_form$toJS2.address,gender=_form$toJS2.gender;var handleChange=this.handleChange,handleLocalRegister=this.handleLocalRegister,defaultNullChange=this.defaultNullChange,handleFileInput=this.handleFileInput,checkedChange=this.checkedChange;return React.createElement(AuthContent,{title:\"MY PAGE\"},React.createElement(InputWithLabel,{label:\"\\uC544\\uC774\\uB514\",name:\"id\",placeholder:\"\\uC544\\uC774\\uB514\",value:id,disabled:true}),React.createElement(InputWithLabel,{label:\"\\uBE44\\uBC00\\uBC88\\uD638\",name:\"password\",placeholder:\"\\uBE44\\uBC00\\uBC88\\uD638\",type:\"password\",value:password,onChange:handleChange}),errorId==='password'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uBE44\\uBC00\\uBC88\\uD638 \\uD655\\uC778\",name:\"passwordConfirm\",placeholder:\"\\uB2E4\\uC2DC \\uD55C\\uBC88 \\uC785\\uB825\",type:\"password\",value:passwordConfirm,onChange:handleChange}),errorId==='passwordConfirm'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uC0DD\\uB144\\uC6D4\\uC77C\",name:\"birthday\",type:\"date\",value:birthday,onChange:defaultNullChange}),errorId==='birthday'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uC774\\uBA54\\uC77C\",name:\"email\",placeholder:\"timeline@naver.com\",type:\"email\",defaultValue:email,onChange:handleChange}),errorId==='email'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uD578\\uB4DC\\uD3F0 \\uBC88\\uD638\",name:\"phone\",placeholder:\"010-1234-1234\",defaultValue:phone,onChange:handleChange}),errorId==='phone'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uC774\\uB984\",name:\"name\",placeholder:\"\\uC774\\uB984\",defaultValue:name,onChange:handleChange}),errorId==='name'&&error&&React.createElement(AuthError,null,error),React.createElement(InputWithLabel,{label:\"\\uCF54\\uBA58\\uD2B8\",name:\"comment\",placeholder:\"\\uBC18\\uAC11\\uC2B5\\uB2C8\\uB2E4.\",defaultValue:comment,onChange:handleChange}),\" \",React.createElement(\"br\",null),errorId==='comment'&&error&&React.createElement(AuthError,null,error),React.createElement(Label,{label:\"\\uC131\\uBCC4\"}),errorId==='gender'&&error&&React.createElement(AuthError,null,error),React.createElement(\"input\",{style:inputStyle,name:\"gender\",type:\"radio\",value:Number('0'),defaultChecked:Number(gender),onChange:checkedChange}),\"\\uC5EC\\uC790\",React.createElement(\"input\",{style:inputStyle,name:\"gender\",type:\"radio\",value:Number('1'),defaultChecked:Number(gender),onChange:checkedChange}),\"\\uB0A8\\uC790\",React.createElement(\"input\",{style:inputStyle,name:\"gender\",type:\"radio\",value:Number('2'),defaultChecked:Number(gender),onChange:checkedChange}),\"others\",React.createElement(InputWithLabel,{label:\"\\uC8FC\\uC18C\",name:\"address\",placeholder:\"\\uC11C\\uC6B8\",defaultValue:address,onChange:defaultNullChange}),errorId==='address'&&error&&React.createElement(AuthError,null,error),React.createElement(AuthButton,{onClick:handleLocalRegister},\"\\uD655\\uC778\"));}}]);return UserModify;}(Component);export default connect(function(state){return{form:state.userPage.getIn(['User','form']),error:state.userPage.getIn(['User','error']),errorId:state.auth.getIn(['register','errorId']),result:state.userPage.get('result'),userPage:state.userPage,password:state.userPage.getIn(['User','form','password'])};},function(dispatch){return{UserPageActions:bindActionCreators(userPageActions,dispatch),UserActions:bindActionCreators(userActions,dispatch),AuthActions:bindActionCreators(authActions,dispatch)};})(UserModify);","map":{"version":3,"sources":["C:/Users/user/fronttimeline/src/containers/User/UserModify.js"],"names":["React","Component","AuthContent","InputWithLabel","AuthButton","AuthError","Label","bindActionCreators","connect","userPageActions","userActions","authActions","storage","setError","validate","checkEmailExists","checkPhoneExists","inputStyle","setAuthActions","setPassword","UserModify","checkIfUserPassed","username","props","get","window","location","href","remove","initialModifyInfo","UserPageActions","checkUserAndGetUser","user","result","toJS","setUserData","console","log","replace","checkedChange","e","target","checked","name","value","changeInput","form","defaultNullChange","handleChange","password","validation","indexOf","handleLocalRegister","error","history","email","id","passwordConfirm","phone","comment","address","gender","birthday","modifyUserInfo","response","status","AuthActions","initializeForm","errorId","handleFileInput","Number","state","userPage","getIn","auth","dispatch","UserActions"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {AuthContent,InputWithLabel,AuthButton,AuthError,Label} from '../../components/Auth';\r\nimport { bindActionCreators } from 'redux';\r\nimport {connect} from 'react-redux';\r\nimport * as userPageActions from '../../redux/modules/userPage';\r\nimport * as userActions from '../../redux/modules/user';\r\nimport * as authActions from '../../redux/modules/auth';\r\nimport storage from '../..//lib/storage';\r\nimport {setError,validate,checkEmailExists,checkPhoneExists,inputStyle\r\n    ,setAuthActions,setPassword} from '../Function/ValidateModule';\r\n\r\nclass UserModify extends Component{        \r\n\r\n    checkIfUserPassed = () => {\r\n        const{username} = this.props;\r\n        if(!storage.get('passed')) window.location.href = '/@' + username+ \"/password\";\r\n        else storage.remove('passed');\r\n    }\r\n    \r\n    initialModifyInfo = async() => {\r\n        const{username,UserPageActions} = this.props;\r\n        try{\r\n        await UserPageActions.checkUserAndGetUser();\r\n        const user = this.props.result.toJS();\r\n        UserPageActions.setUserData(user);\r\n        \r\n        }\r\n        catch(e){\r\n            console.log(e);\r\n            window.location.replace('/@' + username+ \"/password\");\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        this.checkIfUserPassed();\r\n        this.initialModifyInfo();\r\n        setAuthActions(this.props.AuthActions);\r\n    }\r\n    componentWillUnmount(){\r\n        const {UserPageActions} = this.props;\r\n        UserPageActions.initializeForm('User');\r\n        \r\n    }\r\n\r\n    checkedChange = (e) =>{\r\n        const {UserPageActions} = this.props;\r\n        const {name, value} = e.target.checked;\r\n        UserPageActions.changeInput({\r\n          name,\r\n          value,\r\n          form: 'User'  \r\n        });\r\n    }\r\n\r\n    defaultNullChange = (e) =>{\r\n        const {UserPageActions} = this.props;\r\n        const {name, value} = e.target;\r\n        UserPageActions.changeInput({\r\n          name,\r\n          value,\r\n          form: 'User'  \r\n        });\r\n    }\r\n    handleChange = (e) =>{\r\n    const {UserPageActions} = this.props;\r\n    const {name, value} = e.target;\r\n    UserPageActions.changeInput({\r\n      name,\r\n      value,\r\n      form: 'User'  \r\n    });\r\n    setPassword(this.props.password);\r\n    const validation = validate[name](value);\r\n    if(name.indexOf('password') > -1 || !validation) return;\r\n    if( name.indexOf('email') > -1)\r\n        checkEmailExists(value);\r\n     else if(name.indexOf('phone') > -1) \r\n        checkPhoneExists(value);\r\n}\r\nhandleLocalRegister = async () => {\r\n    const{form, UserPageActions, error, history} = this.props;\r\n    const {email, id,password, passwordConfirm, phone,name,comment,address,gender,birthday} = form.toJS();\r\n\r\n    if(error) return; //현재 에러 있는 상태라면 진행 x\r\n    if(!validate['email'](email)\r\n    || !validate['password'](password)\r\n    || !validate['passwordConfirm'](passwordConfirm)\r\n    || !validate['name'](name)\r\n    || !validate['comment'](comment)\r\n    || !validate['phone'](phone)\r\n    || !validate['gender'](gender)\r\n    ){\r\n        //하나라도 실패하면 진행 하지 않음\r\n        return;\r\n    }\r\n    \r\n    try{\r\n        await UserPageActions.modifyUserInfo({\r\n            email,id,password,name,comment,phone,address,gender,birthday\r\n        });\r\n        window.location.href = '/';\r\n        storage.remove('passed');\r\n        } catch(e){\r\n            if(e.response.status === 411)\r\n                setError('조건에 맞는 데이터를 입력해주세요.');\r\n        if(e.response.status === 409)\r\n                setError('다른 회원과 일치하는 데이터가 있습니다. 다시 입력해주세요.');\r\n    }\r\n    }\r\n    render(){\r\n        const {error,form,errorId} = this.props\r\n        const {id,password,passwordConfirm,email,name,phone,birthday,comment,address,gender} =form.toJS();\r\n        const {handleChange,handleLocalRegister,defaultNullChange,handleFileInput,checkedChange} = this; \r\n  \r\n                return(\r\n                <AuthContent title='MY PAGE'>\r\n                <InputWithLabel label = \"아이디\" name=\"id\" placeholder=\"아이디\"\r\n                value = {id}\r\n                disabled/>\r\n                <InputWithLabel label = \"비밀번호\" name=\"password\" placeholder=\"비밀번호\"\r\n                type=\"password\"\r\n                value={password} onChange={handleChange}\r\n                />\r\n                {\r\n                    errorId === 'password' &&error && <AuthError>{error}</AuthError>\r\n                }  \r\n                <InputWithLabel label = \"비밀번호 확인\" name=\"passwordConfirm\" placeholder=\"다시 한번 입력\"\r\n                type=\"password\"\r\n                value={passwordConfirm} onChange={handleChange}\r\n                />\r\n                {\r\n                    errorId === 'passwordConfirm' &&error && <AuthError>{error}</AuthError>\r\n                }  \r\n                <InputWithLabel label = \"생년월일\" name=\"birthday\" \r\n                type=\"date\" \r\n                value = {birthday} onChange={defaultNullChange}\r\n                />\r\n                {\r\n                    errorId === 'birthday' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <InputWithLabel label = \"이메일\" name=\"email\" placeholder=\"timeline@naver.com\" \r\n                type=\"email\"\r\n                defaultValue = {email}\r\n                onChange={handleChange}/>\r\n                {\r\n                    errorId === 'email' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <InputWithLabel label = \"핸드폰 번호\" name=\"phone\" placeholder=\"010-1234-1234\" \r\n                defaultValue={phone}\r\n                onChange={handleChange}/>\r\n                {\r\n                    errorId === 'phone' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <InputWithLabel label = \"이름\" name=\"name\" placeholder=\"이름\" \r\n                defaultValue = {name} onChange={handleChange}/>\r\n                {\r\n                    errorId === 'name' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <InputWithLabel label = \"코멘트\" name=\"comment\" placeholder=\"반갑습니다.\"\r\n                defaultValue = {comment} onChange={handleChange} /> <br/>\r\n                {\r\n                    errorId === 'comment' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <Label label = \"성별\"></Label>\r\n                {\r\n                    errorId === 'gender' &&error && <AuthError>{error}</AuthError>\r\n                } \r\n                <input style ={inputStyle} name= \"gender\" type=\"radio\" value = {Number('0')} defaultChecked = {Number(gender)} onChange={checkedChange} />여자\r\n                <input style ={inputStyle} name=\"gender\" type=\"radio\" value = {Number('1')} defaultChecked ={Number(gender)}  onChange={checkedChange}/>남자\r\n                <input style ={inputStyle} name=\"gender\" type=\"radio\" value = {Number('2')} defaultChecked ={Number(gender)} onChange={checkedChange} />others\r\n                <InputWithLabel label =\"주소\" name =\"address\" placeholder=\"서울\" defaultValue = {address} onChange={defaultNullChange} />\r\n                {\r\n                    errorId === 'address' &&error && <AuthError>{error}</AuthError>\r\n                }              \r\n                <AuthButton onClick={handleLocalRegister}>확인</AuthButton>\r\n                </AuthContent>\r\n            );\r\n        }\r\n}\r\n\r\nexport default connect(\r\n    (state) => ({\r\n        form: state.userPage.getIn(['User','form']),\r\n        error: state.userPage.getIn(['User','error']),\r\n        errorId: state.auth.getIn(['register','errorId']),\r\n        result: state.userPage.get('result'),\r\n        userPage : state.userPage,\r\n        password : state.userPage.getIn(['User','form','password'])\r\n    }),\r\n    (dispatch)=>({\r\n        UserPageActions : bindActionCreators(userPageActions,dispatch),\r\n        UserActions : bindActionCreators(userActions, dispatch),\r\n        AuthActions: bindActionCreators(authActions,dispatch)\r\n    })\r\n)(UserModify);"]},"metadata":{},"sourceType":"module"}