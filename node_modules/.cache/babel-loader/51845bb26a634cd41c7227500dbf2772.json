{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _classCallCheck from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import{bindActionCreators}from'redux';import storage from'../../lib/storage';import*as timelineActions from'../../redux/modules/timeline';import*as commentActions from'../../redux/modules/comment';import*as postActions from'../../redux/modules/post';import*as likeActions from'../../redux/modules/like';import{CommentList,DetailPostView}from'../../components/DetailPost';import{dateTimeToFormatted}from'../Function/dateTimeModule';var PostDetailContainer=/*#__PURE__*/function(_Component){_inherits(PostDetailContainer,_Component);function PostDetailContainer(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostDetailContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostDetailContainer)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={pageCount:0};_this.componentDidMount=function _callee(){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(_this.renderPageInfo());case 2:_context.next=4;return _regeneratorRuntime.awrap(_this.renderCommentInfo());case 4:case\"end\":return _context.stop();}}});};_this.setImageSize=function _callee2(index){var _this$props,presentPost,PostActions,imageSize;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$props=_this.props,presentPost=_this$props.presentPost,PostActions=_this$props.PostActions;_context2.next=3;return _regeneratorRuntime.awrap(_this.getImageSize(presentPost.getIn(['feed','files',index,'original'])));case 3:imageSize=_context2.sent;_context2.next=6;return _regeneratorRuntime.awrap(PostActions.setFileSize(imageSize));case 6:case\"end\":return _context2.stop();}}});};_this.renderPageInfo=function _callee3(){var _this$props2,postid,TimelineActions,imageIndex,index,id,presentPost;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props2=_this.props,postid=_this$props2.postid,TimelineActions=_this$props2.TimelineActions,imageIndex=_this$props2.imageIndex;index=imageIndex.substr(1);id=postid.substr(1);_context3.next=5;return _regeneratorRuntime.awrap(TimelineActions.getFeedInformationDetail(id));case 5:_context3.next=7;return _regeneratorRuntime.awrap(_this.setPostTime());case 7:presentPost=_this.props.presentPost;_context3.next=10;return _regeneratorRuntime.awrap(_this.setImageSize(index));case 10:if(presentPost.getIn(['feed','files'])>1)TimelineActions.setImageArrowVisible('block');case 11:case\"end\":return _context3.stop();}}});};_this.getImageSize=function(url){return new Promise(function(resolve,reject){var image=new Image();image.onload=function(){resolve({width:image.naturalWidth,height:image.naturalHeight});};image.src=url;});};_this.renderCommentInfo=function _callee4(){var _this$props3,CommentActions,TimelineActions,presentPost,postid,id,page,_this$props4,comments,lastComment;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this$props3=_this.props,CommentActions=_this$props3.CommentActions,TimelineActions=_this$props3.TimelineActions,presentPost=_this$props3.presentPost,postid=_this$props3.postid;id=postid.substr(1);page=presentPost.getIn(['feed','commentPage']);_context4.next=5;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,page));case 5:_context4.next=7;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentPage(id));case 7:_this$props4=_this.props,comments=_this$props4.comments,lastComment=_this$props4.lastComment;if(!lastComment){_context4.next=13;break;}_context4.next=11;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment':false}));case 11:_context4.next=15;break;case 13:_context4.next=15;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment':true}));case 15:_context4.next=17;return _regeneratorRuntime.awrap(_this.setCommentTime());case 17:case\"end\":return _context4.stop();}}});};_this.setPostTime=function _callee5(){var _this$props5,presentPost,TimelineActions,time,timestring;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this$props5=_this.props,presentPost=_this$props5.presentPost,TimelineActions=_this$props5.TimelineActions;time=presentPost.getIn(['feed','timestamp']);timestring=dateTimeToFormatted(time);_context5.next=5;return _regeneratorRuntime.awrap(TimelineActions.setDetailTime(timestring));case 5:case\"end\":return _context5.stop();}}});};_this.setCommentTime=function _callee7(){var _this$props6,TimelineActions,commentList,comments;return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$props6=_this.props,TimelineActions=_this$props6.TimelineActions,commentList=_this$props6.commentList;comments=commentList;_context7.next=4;return _regeneratorRuntime.awrap(Promise.all(comments.map(function _callee6(comment,commentIndex){var time,timestring;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:time=comment.timestamp;timestring=dateTimeToFormatted(time);_context6.next=4;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentTime({timestring:timestring,commentIndex:commentIndex}));case 4:case\"end\":return _context6.stop();}}});})));case 4:case\"end\":return _context7.stop();}}});};_this.handleLeft=function _callee8(){var _this$props7,presentPost,imageIndex,history,postid,index,imageSize;return _regeneratorRuntime.async(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this$props7=_this.props,presentPost=_this$props7.presentPost,imageIndex=_this$props7.imageIndex,history=_this$props7.history,postid=_this$props7.postid;index=imageIndex.substr(1);imageSize=presentPost.getIn(['feed','files']).size;_this.setState({pageCount:_this.state.pageCount+1});if(!(parseInt(index)===0)){_context8.next=10;break;}_context8.next=7;return _regeneratorRuntime.awrap(_this.setImageSize(imageSize-1));case 7:history.push(\"/feed/@\".concat(postid,\"/image/:\").concat(imageSize-1));_context8.next=13;break;case 10:_context8.next=12;return _regeneratorRuntime.awrap(_this.setImageSize(parseInt(index)-1));case 12:history.push(\"/feed/@\".concat(postid,\"/image/:\").concat(parseInt(index)-1));case 13:case\"end\":return _context8.stop();}}});};_this.handleRight=function _callee9(){var _this$props8,presentPost,imageIndex,history,postid,PostActions,index,size,imageSize;return _regeneratorRuntime.async(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_this$props8=_this.props,presentPost=_this$props8.presentPost,imageIndex=_this$props8.imageIndex,history=_this$props8.history,postid=_this$props8.postid,PostActions=_this$props8.PostActions;index=imageIndex.substr(1);_context9.next=4;return _regeneratorRuntime.awrap(_this.getImageSize(presentPost.getIn(['feed','files',index,'original'])));case 4:size=_context9.sent;PostActions.setFileSize(size);_this.setState({pageCount:_this.state.pageCount+1});imageSize=presentPost.getIn(['feed','files']).size;if(!(parseInt(index)===imageSize-1)){_context9.next=14;break;}_context9.next=11;return _regeneratorRuntime.awrap(_this.setImageSize(0));case 11:history.push(\"/feed/@\".concat(postid,\"/image/:0\"));_context9.next=17;break;case 14:_context9.next=16;return _regeneratorRuntime.awrap(_this.setImageSize(parseInt(index)+1));case 16:history.push(\"/feed/@\".concat(postid,\"/image/:\").concat(parseInt(index)+1));case 17:case\"end\":return _context9.stop();}}});};_this.handleCommentAdd=function _callee10(){var _this$props9,TimelineActions,CommentActions,presentPost,postid,id,page,_this$props10,comments,lastComment;return _regeneratorRuntime.async(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_this$props9=_this.props,TimelineActions=_this$props9.TimelineActions,CommentActions=_this$props9.CommentActions,presentPost=_this$props9.presentPost,postid=_this$props9.postid;id=postid.substr(1);if(!presentPost.getIn(['feed','trueComment'])){_context10.next=24;break;}page=presentPost.getIn(['feed','commentPage']);_context10.prev=4;_context10.next=7;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,page));case 7:_context10.next=9;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentPage(id));case 9:_this$props10=_this.props,comments=_this$props10.comments,lastComment=_this$props10.lastComment;if(!lastComment){_context10.next=15;break;}_context10.next=13;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment':false}));case 13:_context10.next=17;break;case 15:_context10.next=17;return _regeneratorRuntime.awrap(TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment':true}));case 17:_context10.next=19;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 19:_context10.next=24;break;case 21:_context10.prev=21;_context10.t0=_context10[\"catch\"](4);TimelineActions.setCommentFalse(id);case 24:case\"end\":return _context10.stop();}}},null,null,[[4,21]]);};_this.enterComment=function _callee11(e){var _this$props11,CommentActions,TimelineActions,postid,innerText,id,content,i,commentNum;return _regeneratorRuntime.async(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(!(window.event.keyCode===13)){_context11.next=20;break;}_this$props11=_this.props,CommentActions=_this$props11.CommentActions,TimelineActions=_this$props11.TimelineActions,postid=_this$props11.postid;innerText=e.target.innerText;id=postid.substr(1);content=innerText;content=content.replace(/\\r/g,\"\");content=content.replace(/\\n/g,\"\");_context11.next=9;return _regeneratorRuntime.awrap(CommentActions.writeComment({id:id,content:content}));case 9:_context11.next=11;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,1));case 11:_this.renewComment(id);for(i=0;i<document.getElementsByName('^^comment').length;i++){console.log(document.getElementsByName('^^comment')[i].id);if(parseInt(document.getElementsByName('^^comment')[i].id)===parseInt(id)){document.getElementsByName('^^comment')[i].textContent='';document.getElementsByName('^^comment')[i].blur();}}_context11.next=15;return _regeneratorRuntime.awrap(CommentActions.getCommentNum(id));case 15:commentNum=_this.props.commentNum;_context11.next=18;return _regeneratorRuntime.awrap(TimelineActions.setCommentNum({'commentNum':commentNum,'commentId':id}));case 18:_context11.next=20;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 20:case\"end\":return _context11.stop();}}});};_this.renewComment=function(id){return setTimeout(function _callee12(){var _this$props12,presentComment,TimelineActions;return _regeneratorRuntime.async(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_this$props12=_this.props,presentComment=_this$props12.presentComment,TimelineActions=_this$props12.TimelineActions;_context12.next=3;return _regeneratorRuntime.awrap(TimelineActions.renewDetailComment({'commentId':id,'presentComment':presentComment}));case 3:_context12.next=5;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 5:case\"end\":return _context12.stop();}}});},2000);};_this.handleLikeClick=function _callee13(e){var _this$props13,LikeActions,TimelineActions,id,totalNum;return _regeneratorRuntime.async(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_this$props13=_this.props,LikeActions=_this$props13.LikeActions,TimelineActions=_this$props13.TimelineActions;id=e.target.id;_context13.next=4;return _regeneratorRuntime.awrap(TimelineActions.setLikeKey(id));case 4:_context13.next=6;return _regeneratorRuntime.awrap(LikeActions.clickLike(id));case 6:_context13.next=8;return _regeneratorRuntime.awrap(TimelineActions.setDetailLike('none'));case 8:_context13.next=10;return _regeneratorRuntime.awrap(TimelineActions.setLike('none'));case 10:_context13.prev=10;_context13.next=13;return _regeneratorRuntime.awrap(LikeActions.getLikeAndUserList(id,1));case 13:_context13.next=17;break;case 15:_context13.prev=15;_context13.t0=_context13[\"catch\"](10);case 17:totalNum=_this.props.totalNum;_context13.next=20;return _regeneratorRuntime.awrap(TimelineActions.setDetailLikeNum(totalNum));case 20:_context13.next=22;return _regeneratorRuntime.awrap(TimelineActions.setLikeNum(totalNum));case 22:case\"end\":return _context13.stop();}}},null,null,[[10,15]]);};_this.handleCancelClick=function _callee14(e){var _this$props14,LikeActions,TimelineActions,id,totalNum;return _regeneratorRuntime.async(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_this$props14=_this.props,LikeActions=_this$props14.LikeActions,TimelineActions=_this$props14.TimelineActions;id=e.target.id;_context14.next=4;return _regeneratorRuntime.awrap(TimelineActions.setLikeKey(id));case 4:_context14.next=6;return _regeneratorRuntime.awrap(LikeActions.cancelLike(id));case 6:_context14.next=8;return _regeneratorRuntime.awrap(TimelineActions.setDetailLike('block'));case 8:_context14.next=10;return _regeneratorRuntime.awrap(TimelineActions.setLike('block'));case 10:_context14.prev=10;_context14.next=13;return _regeneratorRuntime.awrap(LikeActions.getLikeAndUserList(id,1));case 13:_context14.next=17;break;case 15:_context14.prev=15;_context14.t0=_context14[\"catch\"](10);case 17:totalNum=_this.props.totalNum;_context14.next=20;return _regeneratorRuntime.awrap(TimelineActions.setDetailLikeNum(totalNum));case 20:_context14.next=22;return _regeneratorRuntime.awrap(TimelineActions.setLikeNum(totalNum));case 22:case\"end\":return _context14.stop();}}},null,null,[[10,15]]);};return _this;}_createClass(PostDetailContainer,[{key:\"render\",value:function render(){if(!storage.get('loggedInfo')){return null;}var _storage$get=storage.get('loggedInfo'),thumbnail=_storage$get.thumbnail,username=_storage$get.username,nickname=_storage$get.nickname;var _this$props15=this.props,presentPost=_this$props15.presentPost,commentList=_this$props15.commentList,fileSize=_this$props15.fileSize,imageIndex=_this$props15.imageIndex,history=_this$props15.history,trueComment=_this$props15.trueComment,postid=_this$props15.postid;var handleLeft=this.handleLeft,handleRight=this.handleRight,enterComment=this.enterComment,handleCommentAdd=this.handleCommentAdd,handleCancelClick=this.handleCancelClick,handleLikeClick=this.handleLikeClick;var index=imageIndex.substr(1);var postId=postid.substr(1);return React.createElement(DetailPostView,{mainfeed:presentPost.toJS(),fileSize:fileSize,imageIndex:index,history:history,handleLeft:handleLeft,handleRight:handleRight,pageCount:this.state.pageCount},React.createElement(CommentList,{comments:commentList,commentThumbnail:thumbnail,name:nickname,userId:username,enterComment:enterComment,handleCommentAdd:handleCommentAdd,trueComment:trueComment,postId:postId,mainfeed:presentPost.toJS(),cancel:handleCancelClick,like:handleLikeClick}));}}]);return PostDetailContainer;}(Component);export default connect(function(state){return{presentPost:state.timeline.get('presentPost'),lastComment:state.comment.get('lastComment'),comments:state.comment.get('commentList'),commentList:state.timeline.getIn(['presentPost','feed','commentList']),fileSize:state.post.get('fileSize'),commentNum:state.comment.get('commentNum'),trueComment:state.timeline.getIn(['presentPost','feed','trueComment']),totalNum:state.like.get('totalNum'),presentComment:state.comment.get('presentComment')};},function(dispatch){return{TimelineActions:bindActionCreators(timelineActions,dispatch),CommentActions:bindActionCreators(commentActions,dispatch),PostActions:bindActionCreators(postActions,dispatch),LikeActions:bindActionCreators(likeActions,dispatch)};})(PostDetailContainer);","map":{"version":3,"sources":["C:/Users/user/fronttimeline/src/containers/Base/PostDetailContainer.js"],"names":["React","Component","connect","bindActionCreators","storage","timelineActions","commentActions","postActions","likeActions","CommentList","DetailPostView","dateTimeToFormatted","PostDetailContainer","state","pageCount","componentDidMount","renderPageInfo","renderCommentInfo","setImageSize","index","props","presentPost","PostActions","getImageSize","getIn","imageSize","setFileSize","postid","TimelineActions","imageIndex","substr","id","getFeedInformationDetail","setPostTime","setImageArrowVisible","url","Promise","resolve","reject","image","Image","onload","width","naturalWidth","height","naturalHeight","src","CommentActions","page","showPostCommentList","setDetailCommentPage","comments","lastComment","setDetailCommentList","setCommentTime","time","timestring","setDetailTime","commentList","all","map","comment","commentIndex","timestamp","setDetailCommentTime","handleLeft","history","size","setState","parseInt","push","handleRight","handleCommentAdd","setCommentFalse","enterComment","e","window","event","keyCode","innerText","target","content","replace","writeComment","renewComment","i","document","getElementsByName","length","console","log","textContent","blur","getCommentNum","commentNum","setCommentNum","setTimeout","presentComment","renewDetailComment","handleLikeClick","LikeActions","setLikeKey","clickLike","setDetailLike","setLike","getLikeAndUserList","totalNum","setDetailLikeNum","setLikeNum","handleCancelClick","cancelLike","get","thumbnail","username","nickname","fileSize","trueComment","postId","toJS","timeline","post","like","dispatch"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport storage from '../../lib/storage';\r\nimport * as timelineActions from '../../redux/modules/timeline';\r\nimport * as commentActions from '../../redux/modules/comment';\r\nimport * as postActions from '../../redux/modules/post';\r\nimport * as likeActions from '../../redux/modules/like';\r\nimport {CommentList,DetailPostView} from '../../components/DetailPost';\r\nimport {dateTimeToFormatted} from '../Function/dateTimeModule';\r\nclass PostDetailContainer extends Component{\r\n    state = {\r\n        pageCount : 0\r\n    }\r\n    componentDidMount=async()=>{\r\n        await this.renderPageInfo();\r\n        await this.renderCommentInfo();\r\n    }\r\n    setImageSize=async(index)=>{\r\n        const{presentPost,PostActions} = this.props;\r\n        let imageSize = await this.getImageSize(presentPost.getIn(['feed','files',index,'original']));\r\n        await PostActions.setFileSize(imageSize);\r\n    }\r\n    renderPageInfo=async()=>{\r\n    const {postid,TimelineActions,imageIndex} = this.props;\r\n    let index = imageIndex.substr(1);\r\n    const id = postid.substr(1);\r\n    await TimelineActions.getFeedInformationDetail(id);\r\n    await this.setPostTime();\r\n    const{presentPost} = this.props;\r\n    await this.setImageSize(index);\r\n    if(presentPost.getIn(['feed','files']) > 1)\r\n        TimelineActions.setImageArrowVisible('block');\r\n    }\r\n    getImageSize= (url)=> {\r\n        return new Promise((resolve, reject) => {\r\n          let image = new Image()\r\n          image.onload = () => {\r\n            resolve({\r\n              width: image.naturalWidth,\r\n              height: image.naturalHeight\r\n            })\r\n          }\r\n          image.src = url\r\n        })\r\n      }\r\n    renderCommentInfo =async()=>{\r\n        const {CommentActions,TimelineActions,presentPost,postid} = this.props;\r\n        const id = postid.substr(1);\r\n        let page = presentPost.getIn(['feed','commentPage']);\r\n            await CommentActions.showPostCommentList(id,page);\r\n            await TimelineActions.setDetailCommentPage(id);\r\n            const{comments,lastComment}=this.props;\r\n            if(lastComment)\r\n            await TimelineActions.setDetailCommentList({'commentId' : id,'commentList':comments,'trueComment' :false});\r\n            else\r\n            await TimelineActions.setDetailCommentList({'commentId' : id,'commentList':comments,'trueComment' :true});\r\n            await this.setCommentTime();\r\n    }\r\n    setPostTime = async() => {\r\n        const{presentPost,TimelineActions} = this.props;\r\n        let time = presentPost.getIn(['feed','timestamp']);\r\n        let timestring = dateTimeToFormatted(time);\r\n        await TimelineActions.setDetailTime(timestring);\r\n    }\r\n\r\n    setCommentTime = async() => {\r\n        const{TimelineActions,commentList} = this.props;\r\n        const comments = commentList;\r\n                await Promise.all(\r\n                    comments.map(\r\n                        async(comment,commentIndex) => {\r\n                            let time = comment.timestamp;\r\n                            let timestring = dateTimeToFormatted(time);\r\n                            await TimelineActions.setDetailCommentTime({timestring:timestring,commentIndex:commentIndex});\r\n                        }\r\n                    )\r\n                );\r\n    }\r\n    handleLeft = async() => {\r\n        const {presentPost,imageIndex,history,postid} = this.props;\r\n        let index = imageIndex.substr(1);\r\n        let imageSize = presentPost.getIn(['feed','files']).size;\r\n        this.setState({\r\n            pageCount : this.state.pageCount + 1\r\n        });\r\n        if(parseInt(index) === 0) {\r\n            await this.setImageSize(imageSize -1);\r\n            history.push(`/feed/@${postid}/image/:${imageSize-1}`);\r\n        }\r\n        else {\r\n            await this.setImageSize(parseInt(index)-1);\r\n            history.push(`/feed/@${postid}/image/:${parseInt(index)-1}`);\r\n        }\r\n    }\r\n    handleRight = async() => {\r\n        const {presentPost,imageIndex,history,postid,PostActions} = this.props;\r\n        let index = imageIndex.substr(1);\r\n        let size = await this.getImageSize(presentPost.getIn(['feed','files',index,'original']));\r\n        PostActions.setFileSize(size);\r\n        this.setState({\r\n            pageCount : this.state.pageCount + 1\r\n        });\r\n        let imageSize = presentPost.getIn(['feed','files']).size;\r\n        if(parseInt(index) === imageSize-1) {\r\n            await this.setImageSize(0);\r\n            history.push(`/feed/@${postid}/image/:0`);\r\n        }\r\n        else {\r\n            await this.setImageSize(parseInt(index)+1);\r\n            history.push(`/feed/@${postid}/image/:${parseInt(index)+1}`);\r\n        }\r\n    }\r\n    handleCommentAdd = async() =>{\r\n        const {TimelineActions,CommentActions,presentPost,postid} = this.props;\r\n        const id = postid.substr(1);\r\n        if(presentPost.getIn(['feed','trueComment'])){\r\n            \r\n            const page = presentPost.getIn(['feed','commentPage']);\r\n            try{\r\n                await CommentActions.showPostCommentList(id,page);\r\n                await TimelineActions.setDetailCommentPage(id);\r\n                const{comments,lastComment}=this.props;\r\n            if(lastComment)\r\n            await TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment' :false});\r\n            else\r\n            await TimelineActions.setDetailCommentList({'commentId':id,'commentList':comments,'trueComment' :true});\r\n            await this.setCommentTime(id);\r\n            }catch(e){\r\n                TimelineActions.setCommentFalse(id);\r\n            }\r\n        } \r\n    }\r\n    enterComment = async(e) =>{\r\n        if(window.event.keyCode === 13){\r\n            const {CommentActions,TimelineActions,postid} = this.props;\r\n            const {innerText} = e.target;\r\n            const id = postid.substr(1);\r\n            var content = innerText;\r\n            content = content.replace(/\\r/g, \"\");\r\n            content = content.replace(/\\n/g, \"\");\r\n            await CommentActions.writeComment({id,content});\r\n            await CommentActions.showPostCommentList(id,1);\r\n            this.renewComment(id);\r\n            \r\n            for(var i = 0; i < document.getElementsByName('^^comment').length; i++){\r\n                console.log(document.getElementsByName('^^comment')[i].id);\r\n                if(parseInt(document.getElementsByName('^^comment')[i].id) === parseInt(id)){\r\n                    document.getElementsByName('^^comment')[i].textContent = '';\r\n                    document.getElementsByName('^^comment')[i].blur();\r\n                }\r\n            }\r\n            await CommentActions.getCommentNum(id);\r\n            var {commentNum} = this.props;\r\n            await TimelineActions.setCommentNum({'commentNum':commentNum,'commentId':id});\r\n            await this.setCommentTime(id);\r\n            \r\n        }\r\n    }\r\n    renewComment=(id)=>\r\n        setTimeout(async()=>{\r\n            const {presentComment,TimelineActions} = this.props;\r\n            await TimelineActions.renewDetailComment({'commentId' : id,'presentComment':presentComment});\r\n            await this.setCommentTime(id);\r\n        },2000);\r\n        handleLikeClick = async(e) =>{\r\n            const {LikeActions,TimelineActions} = this.props;\r\n            const id = e.target.id;\r\n            await TimelineActions.setLikeKey(id);\r\n            await LikeActions.clickLike(id);\r\n            await TimelineActions.setDetailLike('none');\r\n            await TimelineActions.setLike('none');\r\n            try{\r\n            await LikeActions.getLikeAndUserList(id,1);\r\n            }catch(e){}\r\n            const {totalNum} = this.props;\r\n            await TimelineActions.setDetailLikeNum(totalNum);\r\n            await TimelineActions.setLikeNum(totalNum);\r\n               \r\n        }\r\n        handleCancelClick =async(e) => {\r\n            const {LikeActions,TimelineActions} = this.props;\r\n            const id = e.target.id;\r\n            await TimelineActions.setLikeKey(id);\r\n            await LikeActions.cancelLike(id);\r\n            await TimelineActions.setDetailLike('block');\r\n            await TimelineActions.setLike('block');\r\n            try{\r\n            await LikeActions.getLikeAndUserList(id,1);\r\n            }catch(e){}\r\n            const {totalNum} = this.props;\r\n            await TimelineActions.setDetailLikeNum(totalNum);\r\n            await TimelineActions.setLikeNum(totalNum);\r\n        }\r\n    render(){\r\n        if(!storage.get('loggedInfo')) {\r\n            \r\n            return null;\r\n        }\r\n        const {thumbnail,username,nickname} = storage.get('loggedInfo');\r\n        const {presentPost,commentList,fileSize,imageIndex,history,trueComment,postid} = this.props;\r\n        const {handleLeft,handleRight,enterComment,handleCommentAdd,handleCancelClick,\r\n            handleLikeClick} = this;\r\n        let index = imageIndex.substr(1);\r\n        let postId = postid.substr(1);\r\n        return (\r\n            <DetailPostView mainfeed = {presentPost.toJS()}  fileSize = {fileSize} imageIndex = {index}\r\n             history={history} handleLeft={handleLeft} handleRight={handleRight} pageCount = {this.state.pageCount} > \r\n                <CommentList comments = {commentList} commentThumbnail = {thumbnail} name={nickname}\r\n            userId= {username} enterComment = {enterComment} handleCommentAdd = {handleCommentAdd}\r\n            trueComment = {trueComment} postId={postId} mainfeed = {presentPost.toJS()} cancel={handleCancelClick}\r\n            like = {handleLikeClick}/>\r\n            </DetailPostView>\r\n        )\r\n    }\r\n}\r\nexport default connect(\r\n    (state) => ({\r\n        presentPost : state.timeline.get('presentPost'),\r\n        lastComment : state.comment.get('lastComment'),\r\n        comments : state.comment.get('commentList'),\r\n        commentList : state.timeline.getIn(['presentPost','feed','commentList']),\r\n        fileSize : state.post.get('fileSize'),\r\n        commentNum : state.comment.get('commentNum'),\r\n        trueComment : state.timeline.getIn(['presentPost','feed','trueComment']),\r\n        totalNum : state.like.get('totalNum'),\r\n        presentComment : state.comment.get('presentComment')\r\n    }),\r\n    (dispatch) => ({\r\n        TimelineActions : bindActionCreators(timelineActions,dispatch),\r\n        CommentActions : bindActionCreators(commentActions,dispatch),\r\n        PostActions : bindActionCreators(postActions,dispatch),\r\n        LikeActions : bindActionCreators(likeActions,dispatch)\r\n    })\r\n)(PostDetailContainer);"]},"metadata":{},"sourceType":"module"}