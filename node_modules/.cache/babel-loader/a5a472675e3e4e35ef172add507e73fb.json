{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _classCallCheck from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\user\\\\fronttimeline\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import PageWrapper from'../../components/PageWrapper';import{FeedList}from'../../components/PostList';import{bindActionCreators}from'redux';import*as friendActions from'../../redux/modules/friend';import*as postActions from'../../redux/modules/post';import*as timelineActions from'../../redux/modules/timeline';import*as searchActions from'../../redux/modules/search';import*as likeActions from'../../redux/modules/like';import*as commentActions from'../../redux/modules/comment';import storage from'../../lib/storage';var PostListContainer=/*#__PURE__*/function(_Component){_inherits(PostListContainer,_Component);function PostListContainer(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostListContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostListContainer)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.openWriteModal=function(){_this.props.PostActions.setWriteDisplay('block');};_this.handleScroll=function _callee(e){var scrollTop,_window,innerHeight,scrollHeight;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:scrollTop=e.srcElement.scrollingElement.scrollTop;_window=window,innerHeight=_window.innerHeight;scrollHeight=document.body.scrollHeight;if(!(scrollTop+innerHeight>scrollHeight&_this.props.isTruePost)){_context.next=7;break;}_this.getFeedList();_context.next=7;return _regeneratorRuntime.awrap(_this.props.TimelineActions.addPage());case 7:case\"end\":return _context.stop();}}});};_this.componentDidMount=function _callee2(){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:window.addEventListener(\"scroll\",_this.handleScroll);if(storage.get('loggedInfo')){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:_context2.next=5;return _regeneratorRuntime.awrap(_this.props.PostActions.setWrittenData(storage.get('loggedInfo').nickname+'님 무슨 일이 있으셨나요?'));case 5:_context2.next=7;return _regeneratorRuntime.awrap(_this.getFeedList());case 7:_context2.next=9;return _regeneratorRuntime.awrap(_this.props.TimelineActions.addPage());case 9:case\"end\":return _context2.stop();}}});};_this.getFeedList=function _callee3(){var _this$props,TimelineActions,page,isTruePost;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props=_this.props,TimelineActions=_this$props.TimelineActions,page=_this$props.page,isTruePost=_this$props.isTruePost;if(!isTruePost){_context3.next=13;break;}_context3.prev=2;_context3.next=5;return _regeneratorRuntime.awrap(TimelineActions.getMainInformation(page));case 5:_context3.next=7;return _regeneratorRuntime.awrap(_this.setPostTime());case 7:_context3.next=13;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);_context3.next=13;return _regeneratorRuntime.awrap(TimelineActions.setFalsePost());case 13:case\"end\":return _context3.stop();}}},null,null,[[2,9]]);};_this.setPostTime=function _callee5(){var _this$props2,data,TimelineActions;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this$props2=_this.props,data=_this$props2.data,TimelineActions=_this$props2.TimelineActions;_context5.next=3;return _regeneratorRuntime.awrap(Promise.all(data.map(function _callee4(feed,index){var time,timestring;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:time=feed.getIn(['feed','timestamp']);timestring=_this.dateTimeToFormatted(time);_context4.next=4;return _regeneratorRuntime.awrap(TimelineActions.setTime({timestring:timestring,index:index}));case 4:case\"end\":return _context4.stop();}}});})));case 3:case\"end\":return _context5.stop();}}});};_this.setCommentTime=function _callee7(id){var _this$props3,data,TimelineActions,index,comments;return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$props3=_this.props,data=_this$props3.data,TimelineActions=_this$props3.TimelineActions;index=data.findIndex(function(item){return item.getIn(['feed','postId'])===parseInt(id);});comments=data.getIn([index,'feed','commentList']);_context7.next=5;return _regeneratorRuntime.awrap(Promise.all(comments.map(function _callee6(comment,commentIndex){var time,timestring;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:console.log(comment.timestamp);time=comment.timestamp;timestring=_this.dateTimeToFormatted(time);_context6.next=5;return _regeneratorRuntime.awrap(TimelineActions.setCommentTime({timestring:timestring,index:index,commentIndex:commentIndex}));case 5:case\"end\":return _context6.stop();}}});})));case 5:case\"end\":return _context7.stop();}}});};_this.overHashTag=function(e){var TimelineActions=_this.props.TimelineActions;TimelineActions.setHashDisplay('block');TimelineActions.setKey(e.target.id);TimelineActions.setCategoryId(e.target.dataset.category);};_this.outHashTag=function(e){var TimelineActions=_this.props.TimelineActions;TimelineActions.setHashDisplay('none');};_this.handleStateClick=function(e){window.location.href=\"/@:\".concat(e.target.id);};_this.handleLikeClick=function _callee8(e){var _this$props4,LikeActions,TimelineActions,id,totalNum;return _regeneratorRuntime.async(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this$props4=_this.props,LikeActions=_this$props4.LikeActions,TimelineActions=_this$props4.TimelineActions;id=e.target.id;_context8.next=4;return _regeneratorRuntime.awrap(TimelineActions.setLikeKey(id));case 4:_context8.next=6;return _regeneratorRuntime.awrap(LikeActions.clickLike(id));case 6:_context8.next=8;return _regeneratorRuntime.awrap(TimelineActions.setLike('none'));case 8:_context8.prev=8;_context8.next=11;return _regeneratorRuntime.awrap(LikeActions.getLikeAndUserList(id,1));case 11:_context8.next=15;break;case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](8);case 15:totalNum=_this.props.totalNum;_context8.next=18;return _regeneratorRuntime.awrap(TimelineActions.setLikeNum(totalNum));case 18:case\"end\":return _context8.stop();}}},null,null,[[8,13]]);};_this.dateTimeToFormatted=function(dt){var min=60*1000;var c=new Date();var d=new Date(dt);var minsAgo=Math.floor((c-d)/min);var result={'raw':d.getFullYear()+'-'+(d.getMonth()+1>9?'':'0')+(d.getMonth()+1)+'-'+(d.getDate()>9?'':'0')+d.getDate()+' '+(d.getHours()>9?'':'0')+d.getHours()+':'+(d.getMinutes()>9?'':'0')+d.getMinutes()+':'+(d.getSeconds()>9?'':'0')+d.getSeconds(),'month':d.getFullYear()+'-'+(d.getMonth()+1>9?'':'0')+(d.getMonth()+1)+'-'+(d.getDate()>9?'':'0')+d.getDate(),'formatted':''};if(minsAgo<60){// 1시간 내\nresult.formatted=minsAgo+'분 전';}else if(minsAgo<60*24){// 하루 내\nresult.formatted=Math.floor(minsAgo/60)+'시간 전';}else if(minsAgo<60*24*30){// 하루 이상\nresult.formatted=Math.floor(minsAgo/60/24)+'일 전';}else{result.formatted=result.month;}return result.formatted;};_this.handleCancelClick=function _callee9(e){var _this$props5,LikeActions,TimelineActions,id,totalNum;return _regeneratorRuntime.async(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_this$props5=_this.props,LikeActions=_this$props5.LikeActions,TimelineActions=_this$props5.TimelineActions;id=e.target.id;_context9.next=4;return _regeneratorRuntime.awrap(TimelineActions.setLikeKey(id));case 4:_context9.next=6;return _regeneratorRuntime.awrap(LikeActions.cancelLike(id));case 6:_context9.next=8;return _regeneratorRuntime.awrap(TimelineActions.setLike('block'));case 8:_context9.prev=8;_context9.next=11;return _regeneratorRuntime.awrap(LikeActions.getLikeAndUserList(id,1));case 11:_context9.next=15;break;case 13:_context9.prev=13;_context9.t0=_context9[\"catch\"](8);case 15:totalNum=_this.props.totalNum;_context9.next=18;return _regeneratorRuntime.awrap(TimelineActions.setLikeNum(totalNum));case 18:case\"end\":return _context9.stop();}}},null,null,[[8,13]]);};_this.handleComment=function _callee10(e){var _this$props6,CommentActions,TimelineActions,data,id,category,commentdisplay,index,page,_this$props7,commentList,lastComment;return _regeneratorRuntime.async(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_this$props6=_this.props,CommentActions=_this$props6.CommentActions,TimelineActions=_this$props6.TimelineActions,data=_this$props6.data;id=e.target.id;category=e.target.dataset.category;_context10.next=5;return _regeneratorRuntime.awrap(TimelineActions.setCommentCategory(category));case 5:_context10.next=7;return _regeneratorRuntime.awrap(TimelineActions.setCommentDisplay(id));case 7:commentdisplay=_this.props.commentdisplay;if(!(commentdisplay==='block')){_context10.next=25;break;}index=data.findIndex(function(item){return item.getIn(['feed','postId'])===parseInt(id);});page=data.getIn([index,'feed','commentPage']);_context10.next=13;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,page));case 13:_context10.next=15;return _regeneratorRuntime.awrap(TimelineActions.setCommentPage(id));case 15:_this$props7=_this.props,commentList=_this$props7.commentList,lastComment=_this$props7.lastComment;if(!lastComment){_context10.next=21;break;}_context10.next=19;return _regeneratorRuntime.awrap(TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment':false}));case 19:_context10.next=23;break;case 21:_context10.next=23;return _regeneratorRuntime.awrap(TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment':true}));case 23:_context10.next=25;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 25:case\"end\":return _context10.stop();}}});};_this.handleCommentAdd=function _callee11(e){var id,_this$props8,TimelineActions,CommentActions,data,index,page,_this$props9,commentList,lastComment;return _regeneratorRuntime.async(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:id=e.target.id;_this$props8=_this.props,TimelineActions=_this$props8.TimelineActions,CommentActions=_this$props8.CommentActions,data=_this$props8.data;index=data.findIndex(function(item){return item.getIn(['feed','postId'])===parseInt(id);});if(!data.getIn([index,'feed','trueComment'])){_context11.next=25;break;}page=data.getIn([index,'feed','commentPage']);_context11.prev=5;_context11.next=8;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,page));case 8:_context11.next=10;return _regeneratorRuntime.awrap(TimelineActions.setCommentPage(id));case 10:_this$props9=_this.props,commentList=_this$props9.commentList,lastComment=_this$props9.lastComment;if(!lastComment){_context11.next=16;break;}_context11.next=14;return _regeneratorRuntime.awrap(TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment':false}));case 14:_context11.next=18;break;case 16:_context11.next=18;return _regeneratorRuntime.awrap(TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment':true}));case 18:_context11.next=20;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 20:_context11.next=25;break;case 22:_context11.prev=22;_context11.t0=_context11[\"catch\"](5);TimelineActions.setCommentFalse(id);case 25:case\"end\":return _context11.stop();}}},null,null,[[5,22]]);};_this.enterComment=function _callee12(e){var _this$props10,CommentActions,TimelineActions,_e$target,innerText,id,content,i,commentNum;return _regeneratorRuntime.async(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(!(window.event.keyCode===13)){_context12.next=20;break;}_this$props10=_this.props,CommentActions=_this$props10.CommentActions,TimelineActions=_this$props10.TimelineActions;_e$target=e.target,innerText=_e$target.innerText,id=_e$target.id;console.log(id);content=innerText;content=content.replace(/\\r/g,\"\");content=content.replace(/\\n/g,\"\");_context12.next=9;return _regeneratorRuntime.awrap(CommentActions.writeComment({id:id,content:content}));case 9:_context12.next=11;return _regeneratorRuntime.awrap(CommentActions.showPostCommentList(id,1));case 11:_this.renewComment(id);for(i=0;i<document.getElementsByName('^^comment').length;i++){if(parseInt(document.getElementsByName('^^comment')[i].id)===parseInt(id)){document.getElementsByName('^^comment')[i].textContent='';document.getElementsByName('^^comment')[i].blur();}}_context12.next=15;return _regeneratorRuntime.awrap(CommentActions.getCommentNum(id));case 15:commentNum=_this.props.commentNum;_context12.next=18;return _regeneratorRuntime.awrap(TimelineActions.setCommentNum({'commentNum':commentNum,'commentId':id}));case 18:_context12.next=20;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 20:case\"end\":return _context12.stop();}}});};_this.renewComment=function(id){return setTimeout(function _callee13(){var _this$props11,presentComment,TimelineActions;return _regeneratorRuntime.async(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_this$props11=_this.props,presentComment=_this$props11.presentComment,TimelineActions=_this$props11.TimelineActions;_context13.next=3;return _regeneratorRuntime.awrap(TimelineActions.renewComment({'commentId':id,'presentComment':presentComment}));case 3:_context13.next=5;return _regeneratorRuntime.awrap(_this.setCommentTime(id));case 5:case\"end\":return _context13.stop();}}});},2000);};_this.handleImage=function(e){var id=e.target.id;var imageid=e.target.dataset.imageid;_this.props.history.push(\"/feed/@:\".concat(id,\"/image/:\").concat(imageid));};return _this;}_createClass(PostListContainer,[{key:\"getSnapshotBeforeUpdate\",value:function getSnapshotBeforeUpdate(prevProps,prevState){return prevProps.data!==this.props.data;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(snapshot){this.setPostTime();}}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){return this.props.data!==nextProps.data||this.props.writtenData!==nextProps.writtenData||this.props.hashdisplay!==nextProps.hashdisplay;}},{key:\"render\",value:function render(){var data=this.props.data;var style={lineHeight:'160%'};if(!storage.get('loggedInfo')){return null;}var username=storage.get('loggedInfo').nickname;var thumbnail=storage.get('loggedInfo').thumbnail;var _this$props12=this.props,writtenData=_this$props12.writtenData,hashdisplay=_this$props12.hashdisplay,keyid=_this$props12.keyid,category=_this$props12.category,totalNum=_this$props12.totalNum,commentCategory=_this$props12.commentCategory,PostActions=_this$props12.PostActions;var openWriteModal=this.openWriteModal,overHashTag=this.overHashTag,outHashTag=this.outHashTag,handleStateClick=this.handleStateClick,handleLikeClick=this.handleLikeClick,enterComment=this.enterComment,handleCommentAdd=this.handleCommentAdd,handleCancelClick=this.handleCancelClick,handleComment=this.handleComment,handleImage=this.handleImage;if(writtenData==='')PostActions.setWrittenData(\"\".concat(username,\"\\uB2D8, \\uBB34\\uC2A8 \\uC77C\\uC774 \\uC788\\uC73C\\uC168\\uB098\\uC694?\"));return React.createElement(PageWrapper,null,React.createElement(FeedList,{mainfeed:data,username:username,onclick:openWriteModal,stateclick:handleStateClick,content:writtenData.split('\\n').map(function(line,index){return React.createElement(\"div\",{key:index,style:style},line,React.createElement(\"br\",null));}),hover:overHashTag,nothover:outHashTag,hashdisplay:hashdisplay,keyid:keyid,like:handleLikeClick,category:category,cancel:handleCancelClick,totalNum:totalNum,handleComment:handleComment,handleCommentAdd:handleCommentAdd,thumbnail:thumbnail,commentCategory:commentCategory,enterComment:enterComment,handleImage:handleImage}));}}]);return PostListContainer;}(Component);export default connect(function(state){return{writtenData:state.post.get('writtenData'),data:state.timeline.get('mainfeed'),page:state.timeline.get('page'),isTruePost:state.timeline.get('isTruePost'),hashdisplay:state.timeline.get('hashdisplay'),keyid:state.timeline.get('keyid'),category:state.timeline.get('categoryid'),totalNum:state.like.get('totalNum'),commentList:state.comment.get('commentList'),commentNum:state.comment.get('commentNum'),commentCategory:state.timeline.get('commentCategory'),commentdisplay:state.timeline.get('commentdisplay'),postId:state.post.get('postId'),presentComment:state.comment.get('presentComment'),lastComment:state.comment.get('lastComment')};},function(dispatch){return{TimelineActions:bindActionCreators(timelineActions,dispatch),FriendActions:bindActionCreators(friendActions,dispatch),SearchActions:bindActionCreators(searchActions,dispatch),PostActions:bindActionCreators(postActions,dispatch),LikeActions:bindActionCreators(likeActions,dispatch),CommentActions:bindActionCreators(commentActions,dispatch)};})(PostListContainer);","map":{"version":3,"sources":["C:/Users/user/fronttimeline/src/containers/Base/PostListContainer.js"],"names":["React","Component","connect","PageWrapper","FeedList","bindActionCreators","friendActions","postActions","timelineActions","searchActions","likeActions","commentActions","storage","PostListContainer","openWriteModal","props","PostActions","setWriteDisplay","handleScroll","e","scrollTop","srcElement","scrollingElement","window","innerHeight","scrollHeight","document","body","isTruePost","getFeedList","TimelineActions","addPage","componentDidMount","addEventListener","get","setWrittenData","nickname","page","getMainInformation","setPostTime","setFalsePost","data","Promise","all","map","feed","index","time","getIn","timestring","dateTimeToFormatted","setTime","setCommentTime","id","findIndex","item","parseInt","comments","comment","commentIndex","console","log","timestamp","overHashTag","setHashDisplay","setKey","target","setCategoryId","dataset","category","outHashTag","handleStateClick","location","href","handleLikeClick","LikeActions","setLikeKey","clickLike","setLike","getLikeAndUserList","totalNum","setLikeNum","dt","min","c","Date","d","minsAgo","Math","floor","result","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","formatted","month","handleCancelClick","cancelLike","handleComment","CommentActions","setCommentCategory","setCommentDisplay","commentdisplay","showPostCommentList","setCommentPage","commentList","lastComment","setCommentList","handleCommentAdd","setCommentFalse","enterComment","event","keyCode","innerText","content","replace","writeComment","renewComment","i","getElementsByName","length","textContent","blur","getCommentNum","commentNum","setCommentNum","setTimeout","presentComment","handleImage","imageid","history","push","prevProps","prevState","snapshot","nextProps","nextState","writtenData","hashdisplay","style","lineHeight","username","thumbnail","keyid","commentCategory","split","line","state","post","timeline","like","postId","dispatch","FriendActions","SearchActions"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport PageWrapper from '../../components/PageWrapper';\r\nimport {FeedList} from '../../components/PostList';\r\nimport {bindActionCreators} from 'redux';\r\nimport * as friendActions from '../../redux/modules/friend';\r\nimport * as postActions from '../../redux/modules/post';\r\nimport * as timelineActions from '../../redux/modules/timeline';\r\nimport * as searchActions from '../../redux/modules/search';\r\nimport * as likeActions from '../../redux/modules/like';\r\nimport * as commentActions from '../../redux/modules/comment';\r\nimport storage from '../../lib/storage';\r\nclass PostListContainer extends Component{\r\n    openWriteModal = () => {\r\n        this.props.PostActions.setWriteDisplay('block');\r\n    }\r\n    handleScroll = async(e) => {\r\n        const scrollTop =e.srcElement.scrollingElement.scrollTop;\r\n        const { innerHeight } = window;\r\n      const { scrollHeight } = document.body;\r\n    \r\n      if (scrollTop+innerHeight >scrollHeight & this.props.isTruePost) {\r\n        this.getFeedList();\r\n        await this.props.TimelineActions.addPage();\r\n        }\r\n    }\r\n    componentDidMount= async() =>{\r\n        window.addEventListener(\"scroll\", this.handleScroll);\r\n        if(!storage.get('loggedInfo')) return ;\r\n        await this.props.PostActions.setWrittenData(storage.get('loggedInfo').nickname + '님 무슨 일이 있으셨나요?');\r\n         await this.getFeedList();\r\n        await this.props.TimelineActions.addPage();\r\n      }\r\n\r\n      getFeedList = async() => {\r\n        const{TimelineActions,page,isTruePost} = this.props;\r\n        if(isTruePost){\r\n            try{\r\n                await TimelineActions.getMainInformation(page);\r\n                await this.setPostTime();\r\n            }catch(e){\r\n                await TimelineActions.setFalsePost();\r\n            }\r\n            \r\n        }\r\n    }\r\n    setPostTime = async() => {\r\n        const{data,TimelineActions} = this.props;\r\n                await Promise.all(\r\n                    data.map(\r\n                        async(feed,index) => {\r\n                            let time = feed.getIn(['feed','timestamp']);\r\n                            let timestring = this.dateTimeToFormatted(time);\r\n                            await TimelineActions.setTime({timestring:timestring,index : index});\r\n                        }\r\n                    )\r\n                );\r\n    }\r\n\r\n    setCommentTime = async(id) => {\r\n        const{data,TimelineActions} = this.props;\r\n        let index = data.findIndex(item => item.getIn(['feed','postId'])===parseInt(id));\r\n        const comments = data.getIn([index,'feed','commentList']);\r\n                await Promise.all(\r\n                    comments.map(\r\n                        async(comment,commentIndex) => {\r\n                            console.log(comment.timestamp);\r\n                            let time = comment.timestamp;\r\n                            let timestring = this.dateTimeToFormatted(time);\r\n                            await TimelineActions.setCommentTime({timestring:timestring,index : index,commentIndex:commentIndex});\r\n                        }\r\n                    )\r\n                );\r\n    }\r\n    \r\n    overHashTag = (e) =>{\r\n        const {TimelineActions} = this.props;\r\n        TimelineActions.setHashDisplay('block');\r\n        TimelineActions.setKey(e.target.id);\r\n        TimelineActions.setCategoryId(e.target.dataset.category);\r\n    }\r\n    outHashTag = (e) =>{\r\n        const {TimelineActions} = this.props;\r\n        TimelineActions.setHashDisplay('none');\r\n          \r\n    }\r\n    handleStateClick = (e) =>{\r\n        window.location.href =`/@:${e.target.id}`;\r\n    }\r\n    handleLikeClick = async(e) =>{\r\n        const {LikeActions,TimelineActions} = this.props;\r\n        const id = e.target.id;\r\n        await TimelineActions.setLikeKey(id);\r\n        await LikeActions.clickLike(id);\r\n        await TimelineActions.setLike('none');\r\n        try{\r\n        await LikeActions.getLikeAndUserList(id,1);\r\n        }catch(e){}\r\n        const {totalNum} = this.props;\r\n        await TimelineActions.setLikeNum(totalNum);\r\n           \r\n    }\r\n     dateTimeToFormatted=(dt)=> {\r\n\t\tconst min = 60 * 1000;\r\n\t\tconst c = new Date();\r\n\t\tvar d = new Date(dt);\r\n\t\tvar minsAgo = Math.floor((c - d) / (min));\r\n\r\n\t\tvar result = {\r\n            'raw': d.getFullYear() + '-' + (d.getMonth() + 1 > 9 ? '' : '0') + (d.getMonth() + 1) \r\n            + '-' + (d.getDate() > 9 ? '' : '0') +  d.getDate() + ' ' + (d.getHours() > 9 ? '' : '0') \r\n            +  d.getHours() + ':' + (d.getMinutes() > 9 ? '' : '0') +  d.getMinutes() + ':'  \r\n            + (d.getSeconds() > 9 ? '' : '0') +  d.getSeconds(),\r\n            'month' : d.getFullYear() + '-' + (d.getMonth() + 1 > 9 ? '' : '0') + (d.getMonth() + 1) \r\n            + '-' + (d.getDate() > 9 ? '' : '0') +  d.getDate(),\r\n\t\t\t'formatted': ''\r\n\t\t};\r\n\r\n\t\tif (minsAgo < 60) { // 1시간 내\r\n\t\t\tresult.formatted = minsAgo + '분 전';\r\n\t\t} else if (minsAgo < 60 * 24) { // 하루 내\r\n\t\t\tresult.formatted = Math.floor(minsAgo / 60) + '시간 전';\r\n\t\t} else if(minsAgo < 60 * 24 * 30) { // 하루 이상\r\n\t\t\tresult.formatted = Math.floor(minsAgo / 60 / 24) + '일 전';\r\n\t\t} else{\r\n            result.formatted = result.month;\r\n        }\r\n\t\treturn result.formatted;\r\n\t};\r\n    handleCancelClick =async(e) => {\r\n        const {LikeActions,TimelineActions} = this.props;\r\n        const id = e.target.id;\r\n        await TimelineActions.setLikeKey(id);\r\n        await LikeActions.cancelLike(id);\r\n        await TimelineActions.setLike('block');\r\n        try{\r\n        await LikeActions.getLikeAndUserList(id,1);\r\n        }catch(e){}\r\n        const {totalNum} = this.props;\r\n        await TimelineActions.setLikeNum(totalNum);\r\n    }\r\n    handleComment =async(e)=>{\r\n        const {CommentActions,TimelineActions,data} = this.props;\r\n        const {id} = e.target;\r\n        const {category} = e.target.dataset;\r\n        await TimelineActions.setCommentCategory(category);\r\n        await TimelineActions.setCommentDisplay(id);\r\n        const{commentdisplay} = this.props;\r\n        if(commentdisplay === 'block'){\r\n            let index = data.findIndex(item => item.getIn(['feed','postId'])===parseInt(id));\r\n            let page = data.getIn([index,'feed','commentPage']);\r\n            await CommentActions.showPostCommentList(id,page);\r\n            await TimelineActions.setCommentPage(id);\r\n            const{commentList,lastComment}=this.props;\r\n            if(lastComment)\r\n            await TimelineActions.setCommentList({'commentId' : id,'commentList':commentList,'trueComment' :false});\r\n            else\r\n            await TimelineActions.setCommentList({'commentId' : id,'commentList':commentList,'trueComment' :true});\r\n            await this.setCommentTime(id);\r\n        }\r\n    }\r\n\r\n    getSnapshotBeforeUpdate(prevProps, prevState) {\r\n        return prevProps.data !== this.props.data;\r\n    }\r\n   componentDidUpdate(prevProps, prevState, snapshot){\r\n        if(snapshot){\r\n            this.setPostTime();\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        return this.props.data !== nextProps.data || this.props.writtenData !== nextProps.writtenData ||\r\n        this.props.hashdisplay !== nextProps.hashdisplay;\r\n    }\r\n    handleCommentAdd = async(e) =>{\r\n        const {id} = e.target;\r\n        const {TimelineActions,CommentActions,data} = this.props;\r\n        const index = data.findIndex(item => item.getIn(['feed','postId']) ===parseInt(id));\r\n        if(data.getIn([index,'feed','trueComment'])){\r\n            \r\n            const page = data.getIn([index,'feed','commentPage']);\r\n            try{\r\n                await CommentActions.showPostCommentList(id,page);\r\n                await TimelineActions.setCommentPage(id);\r\n                const{commentList,lastComment}=this.props;\r\n            if(lastComment)\r\n            await TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment' :false});\r\n            else\r\n            await TimelineActions.setCommentList({'commentId':id,'commentList':commentList,'trueComment' :true});\r\n            await this.setCommentTime(id);\r\n            }catch(e){\r\n                TimelineActions.setCommentFalse(id);\r\n            }\r\n        } \r\n    }\r\n    enterComment = async(e) =>{\r\n        if(window.event.keyCode === 13){\r\n            const {CommentActions,TimelineActions} = this.props;\r\n            const {innerText,id} = e.target;\r\n            console.log(id);\r\n            var content = innerText;\r\n            content = content.replace(/\\r/g, \"\");\r\n            content = content.replace(/\\n/g, \"\");\r\n            await CommentActions.writeComment({id,content});\r\n            await CommentActions.showPostCommentList(id,1);\r\n            this.renewComment(id);\r\n            for(var i = 0; i < document.getElementsByName('^^comment').length; i++){\r\n                if(parseInt(document.getElementsByName('^^comment')[i].id) === parseInt(id)){\r\n                    document.getElementsByName('^^comment')[i].textContent = '';\r\n                    document.getElementsByName('^^comment')[i].blur();\r\n                }\r\n            }\r\n            await CommentActions.getCommentNum(id);\r\n            var {commentNum} = this.props;\r\n            await TimelineActions.setCommentNum({'commentNum':commentNum,'commentId':id});\r\n            await this.setCommentTime(id);\r\n            \r\n        }\r\n    }\r\n    renewComment=(id)=>\r\n        setTimeout(async()=>{\r\n            const {presentComment,TimelineActions} = this.props;\r\n            await TimelineActions.renewComment({'commentId' : id,'presentComment':presentComment});\r\n            await this.setCommentTime(id);\r\n        },2000);\r\n\r\n    handleImage =(e) =>{\r\n        const {id} = e.target;\r\n        const {imageid} = e.target.dataset;\r\n        this.props.history.push(`/feed/@:${id}/image/:${imageid}`);\r\n    }\r\n    render(){\r\n        \r\n        const {data} = this.props;\r\n        const style = {\r\n            lineHeight: '160%'\r\n        };\r\n        if(!storage.get('loggedInfo')) {\r\n            \r\n            return null;\r\n        }\r\n        const username = storage.get('loggedInfo').nickname;\r\n        const thumbnail = storage.get('loggedInfo').thumbnail;\r\n        const {writtenData,hashdisplay,keyid,category,totalNum,commentCategory,PostActions} = this.props;\r\n        const {openWriteModal,overHashTag,outHashTag,handleStateClick,handleLikeClick,enterComment,handleCommentAdd\r\n            ,handleCancelClick,handleComment,handleImage} = this;\r\n        if(writtenData === '') PostActions.setWrittenData(`${username}님, 무슨 일이 있으셨나요?`);\r\n        return(\r\n            <PageWrapper>\r\n            <FeedList mainfeed={data} username = {username} onclick = {openWriteModal} stateclick={handleStateClick} content ={\r\n                writtenData.split('\\n').map( (line,index) => {\r\n            return (<div key={index} style={style} >{line}<br/></div>)\r\n          })}\r\n           hover = {overHashTag} nothover={outHashTag} hashdisplay={hashdisplay} keyid = {keyid} like={handleLikeClick}\r\n         category = {category} cancel={handleCancelClick} totalNum={totalNum} handleComment={handleComment} handleCommentAdd = {handleCommentAdd}\r\n          thumbnail={thumbnail} commentCategory={commentCategory} enterComment={enterComment} handleImage={handleImage}/>\r\n         \r\n            </PageWrapper>\r\n        );\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    (state) => ({\r\n        writtenData : state.post.get('writtenData'),\r\n        data : state.timeline.get('mainfeed'),\r\n        page : state.timeline.get('page'),\r\n        isTruePost : state.timeline.get('isTruePost'),\r\n        hashdisplay : state.timeline.get('hashdisplay'),\r\n        keyid : state.timeline.get('keyid'),\r\n        category : state.timeline.get('categoryid'),\r\n        totalNum : state.like.get('totalNum'),\r\n        commentList : state.comment.get('commentList'),\r\n        commentNum : state.comment.get('commentNum'),\r\n        commentCategory : state.timeline.get('commentCategory'),\r\n        commentdisplay : state.timeline.get('commentdisplay'),\r\n        postId : state.post.get('postId'),\r\n        presentComment : state.comment.get('presentComment'),\r\n        lastComment : state.comment.get('lastComment')\r\n    }),\r\n    (dispatch) => ({\r\n        TimelineActions: bindActionCreators(timelineActions, dispatch),\r\n        FriendActions: bindActionCreators(friendActions, dispatch),\r\n        SearchActions : bindActionCreators(searchActions,dispatch),\r\n        PostActions : bindActionCreators(postActions,dispatch),\r\n        LikeActions : bindActionCreators(likeActions,dispatch),\r\n        CommentActions : bindActionCreators(commentActions,dispatch)\r\n\r\n    })\r\n)(PostListContainer);"]},"metadata":{},"sourceType":"module"}